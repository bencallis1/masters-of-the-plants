'use strict';

angular.module('plantMasters', ['ui.router']).config(function ($urlRouterProvider, $stateProvider) {
    $stateProvider.state('main', {
        url: '/',
        controller: 'MainCtrl',
        templateUrl: 'views/main.html'
    });
    $urlRouterProvider.otherwise('/');
});
'use strict';

angular.module('plantMasters').controller('MainCtrl', function ($scope, $window, MainSvc) {

  //HTML5 Geolocation
  $window.navigator.geolocation.getCurrentPosition(function (position) {
    var location = [position.coords.latitude, position.coords.longitude];

    $scope.$apply(function () {
      $scope.coordinates = location;
    });
  });

  //Geolocation by zipcode
  //invoke function in service, get zipcode geolocation info
  $scope.$watch('zip', function (newValue, oldValue) {
    if (newValue) {
      var isNum = /^\d+$/.test(newValue);
      if (newValue.length > 5 || !isNum) {
        $scope.zip = oldValue;
      }
    }
  });

  var request = {};
  $scope.submitForm = function () {
    request.zip = $scope.zip;
    MainSvc.postZip(request);
  };

  //invoke function to get hardiness level based on lat/lng, put on scope
});
'use strict';

angular.module('plantMasters').service('MainSvc', function ($http, $q, $state) {

  this.postZip = function (request) {

    $http.post("http://localhost:3000/zip/", request).success(function (result) {
      console.log(result);
      coords = result;
    }).error(function () {
      console.log('error');
    });
  };

  //http post, return geolocation info

  //query hardiness, return hardiness level
});